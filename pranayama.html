<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pranayama Breathing ‚Äì Calm Hub</title>
  <style>
    * { 
      margin:0; 
      padding:0; 
      box-sizing:border-box; 
      font-family:'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; 
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 24px 12px;
      background-image: url("image.jpg");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      position: relative;
    }

    body::before {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(15,23,42,0.15);
      backdrop-filter: blur(4px);
      z-index: 1;
    }

    .shell {
      width:100%;
      max-width:900px;
      border-radius:28px;
      padding:48px 40px;
      background:rgba(15,23,42,0.96);
      color:#e5e7eb;
      border:1px solid rgba(255,255,255,0.28);
      box-shadow: 
        0 32px 80px rgba(15,23,42,0.92),
        inset 0 1px 0 rgba(255,255,255,0.08);
      backdrop-filter:blur(28px);
      -webkit-backdrop-filter:blur(28px);
      position:relative;
      z-index:2;
      text-align:center;
    }

    .shell::before {
      content:'';
      position:absolute;
      top:0;
      left:0;
      right:0;
      height:1px;
      background:linear-gradient(90deg, transparent, rgba(251,191,36,0.8), rgba(245,158,11,0.8), transparent);
    }

    h1 {
      font-size:36px;
      font-weight:800;
      background:linear-gradient(135deg, #fde68a 0%, #fbbf24 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      margin-bottom:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
    }

    .subtitle {
      font-size:16px;
      color:rgba(255,255,255,0.85);
      margin-bottom:40px;
      font-weight:500;
    }

    /* TECHNIQUE SELECTOR */
    .technique-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));
      gap:20px;
      margin:32px 0;
    }

    .technique-card {
      padding:28px 24px;
      background:linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border:2px solid rgba(255,255,255,0.12);
      border-radius:20px;
      cursor:pointer;
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      backdrop-filter:blur(20px);
      position:relative;
      overflow:hidden;
    }

    .technique-card::before {
      content:'';
      position:absolute;
      top:0;
      left:0;
      right:0;
      height:3px;
      background:linear-gradient(90deg, #fbbf24, #f59e0b);
      transform:scaleX(0);
      transition:transform 0.3s;
    }

    .technique-card:hover::before, .technique-card.active::before {
      transform:scaleX(1);
    }

    .technique-card:hover, .technique-card.active {
      border-color:rgba(251,191,36,0.6);
      background:linear-gradient(145deg, rgba(251,191,36,0.2), rgba(245,158,11,0.15));
      transform:translateY(-4px);
      box-shadow:0 12px 32px rgba(251,191,36,0.3);
    }

    .technique-icon {
      font-size:40px;
      margin-bottom:12px;
    }

    .technique-card h3 {
      font-size:20px;
      font-weight:800;
      color:#ffffff;
      margin-bottom:8px;
    }

    .technique-card p {
      font-size:14px;
      color:rgba(255,255,255,0.7);
      line-height:1.6;
      margin-bottom:12px;
    }

    .technique-meta {
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:12px;
    }

    .meta-badge {
      padding:6px 12px;
      background:rgba(251,191,36,0.2);
      border-radius:12px;
      font-size:11px;
      font-weight:700;
      color:#fbbf24;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }

    /* BREATHING SECTION */
    .breathing-section {
      background:linear-gradient(145deg, rgba(251,191,36,0.15), rgba(245,158,11,0.1));
      border-radius:24px;
      padding:48px 32px;
      margin:40px 0;
      border:1px solid rgba(251,191,36,0.3);
      backdrop-filter:blur(20px);
    }

    .technique-description {
      background:rgba(251,191,36,0.1);
      border-radius:16px;
      padding:20px;
      margin-bottom:32px;
      border:1px solid rgba(251,191,36,0.2);
    }

    .technique-description h4 {
      font-size:18px;
      font-weight:700;
      color:#fbbf24;
      margin-bottom:12px;
    }

    .technique-description p {
      font-size:14px;
      color:rgba(255,255,255,0.85);
      line-height:1.7;
    }

    .breathing-visual {
      width:300px;
      height:300px;
      margin:32px auto;
      border-radius:50%;
      background:linear-gradient(135deg, #fcd34d, #f59e0b);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      position:relative;
      transition:all 3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow:0 20px 60px rgba(252,211,77,0.5);
    }

    .breathing-visual::before {
      content:'';
      position:absolute;
      inset:-10px;
      border-radius:50%;
      background:linear-gradient(135deg, rgba(251,191,36,0.3), rgba(245,158,11,0.2));
      z-index:-1;
      animation:pulse 3s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform:scale(1); opacity:0.5; }
      50% { transform:scale(1.1); opacity:0.8; }
    }

    .breathing-visual.active {
      transform:scale(1.25);
      box-shadow:0 30px 80px rgba(252,211,77,0.8);
    }

    .breathing-visual.bhastrika-active {
      animation:rapid-pulse 0.5s ease-in-out infinite;
    }

    @keyframes rapid-pulse {
      0%, 100% { transform:scale(1); }
      50% { transform:scale(1.15); }
    }

    .visual-instruction {
      font-size:24px;
      font-weight:800;
      color:#1e293b;
      margin-bottom:12px;
      text-shadow:0 2px 8px rgba(255,255,255,0.4);
      text-align:center;
      line-height:1.3;
    }

    .visual-counter {
      font-size:72px;
      font-weight:800;
      color:#1e293b;
      text-shadow:0 2px 8px rgba(255,255,255,0.4);
    }

    .nostril-indicator {
      display:flex;
      gap:40px;
      justify-content:center;
      margin-top:32px;
    }

    .nostril {
      text-align:center;
      padding:16px 24px;
      background:rgba(255,255,255,0.1);
      border-radius:16px;
      border:2px solid transparent;
      transition:all 0.3s;
    }

    .nostril.active {
      border-color:#fbbf24;
      background:rgba(251,191,36,0.2);
      box-shadow:0 8px 24px rgba(251,191,36,0.4);
    }

    .nostril-icon {
      font-size:32px;
      margin-bottom:8px;
    }

    .nostril-label {
      font-size:14px;
      font-weight:700;
      color:rgba(255,255,255,0.8);
    }

    .nostril.active .nostril-label {
      color:#fbbf24;
    }

    /* PROGRESS */
    .round-tracker {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:16px;
      margin:24px 0;
      padding:16px;
      background:rgba(255,255,255,0.08);
      border-radius:16px;
    }

    .round-tracker span {
      font-size:15px;
      font-weight:700;
      color:rgba(255,255,255,0.9);
    }

    .round-tracker .round-num {
      font-size:28px;
      color:#fbbf24;
    }

    /* CONTROLS */
    .controls {
      display:flex;
      gap:16px;
      justify-content:center;
      margin-top:40px;
      flex-wrap:wrap;
    }

    .btn {
      padding:16px 36px;
      border-radius:28px;
      border:none;
      font-size:15px;
      font-weight:700;
      cursor:pointer;
      transition:all 0.35s cubic-bezier(0.4,0,0.2,1);
      position:relative;
      overflow:hidden;
    }

    .btn-primary {
      background:linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      color:#1e293b;
      box-shadow:0 12px 32px rgba(251,191,36,0.4);
    }

    .btn-primary::before {
      content:'';
      position:absolute;
      top:0;
      left:-100%;
      width:100%;
      height:100%;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition:left 0.5s;
    }

    .btn-primary:hover::before {
      left:100%;
    }

    .btn-primary:hover {
      transform:translateY(-3px);
      box-shadow:0 20px 50px rgba(251,191,36,0.5);
    }

    .btn-secondary {
      background:rgba(255,255,255,0.12);
      color:#ffffff;
      border:1px solid rgba(255,255,255,0.28);
    }

    .btn-secondary:hover {
      background:rgba(255,255,255,0.2);
      transform:translateY(-2px);
    }

    /* STATS */
    .stats-section {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));
      gap:16px;
      margin-top:40px;
      padding-top:40px;
      border-top:1px solid rgba(255,255,255,0.15);
    }

    .stat-card {
      background:linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border-radius:20px;
      padding:24px 16px;
      border:1px solid rgba(255,255,255,0.12);
      backdrop-filter:blur(20px);
    }

    .stat-value {
      font-size:36px;
      font-weight:800;
      background:linear-gradient(135deg, #10b981, #14f195);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      display:block;
      margin-bottom:8px;
    }

    .stat-label {
      font-size:13px;
      color:rgba(255,255,255,0.7);
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }

    /* BENEFITS */
    .benefits-section {
      margin-top:40px;
    }

    .benefits-section h3 {
      font-size:20px;
      font-weight:700;
      color:#ffffff;
      margin-bottom:20px;
      text-align:center;
    }

    .benefits-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
      gap:16px;
    }

    .benefit-card {
      padding:20px;
      background:linear-gradient(145deg, rgba(16,185,129,0.15), rgba(5,150,105,0.1));
      border-radius:16px;
      border:1px solid rgba(16,185,129,0.25);
      backdrop-filter:blur(10px);
      transition:all 0.3s;
    }

    .benefit-card:hover {
      transform:translateY(-4px);
      box-shadow:0 12px 32px rgba(16,185,129,0.3);
    }

    .benefit-card h4 {
      font-size:32px;
      margin-bottom:8px;
    }

    .benefit-card p {
      font-size:14px;
      color:rgba(255,255,255,0.85);
      font-weight:600;
      line-height:1.5;
    }

    /* GUIDE */
    .guide-section {
      background:linear-gradient(145deg, rgba(59,130,246,0.15), rgba(139,92,246,0.1));
      border-radius:24px;
      padding:32px;
      margin-top:40px;
      border:1px solid rgba(59,130,246,0.25);
      text-align:left;
    }

    .guide-section h3 {
      font-size:20px;
      font-weight:700;
      color:#ffffff;
      margin-bottom:20px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .steps-grid {
      display:grid;
      gap:16px;
    }

    .step-card {
      padding:20px;
      background:rgba(255,255,255,0.08);
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.12);
      display:flex;
      gap:16px;
      align-items:flex-start;
    }

    .step-number {
      width:36px;
      height:36px;
      border-radius:50%;
      background:linear-gradient(135deg, #3b82f6, #8b5cf6);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
      font-weight:800;
      color:#ffffff;
      flex-shrink:0;
    }

    .step-content h4 {
      font-size:16px;
      font-weight:700;
      color:#ffffff;
      margin-bottom:6px;
    }

    .step-content p {
      font-size:14px;
      color:rgba(255,255,255,0.8);
      line-height:1.6;
    }

    .back-link {
      margin-top:40px;
    }

    .back-link a {
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:14px 28px;
      border-radius:24px;
      border:1px solid rgba(255,255,255,0.35);
      background:rgba(255,255,255,0.15);
      color:#ffffff;
      font-size:14px;
      font-weight:600;
      text-decoration:none;
      backdrop-filter:blur(24px);
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
    }

    .back-link a:hover {
      background:rgba(255,255,255,0.28);
      transform:translateY(-2px);
      box-shadow:0 16px 40px rgba(255,255,255,0.18);
    }

    @media (max-width: 768px) {
      .shell { padding:32px 24px; }
      h1 { font-size:28px; }
      .breathing-visual { width:240px; height:240px; }
      .visual-counter { font-size:56px; }
      .technique-grid { grid-template-columns:1fr; }
      .nostril-indicator { gap:20px; }
    }
  </style>
</head>
<body>
  <div class="shell">
    <h1>üïâ Pranayama Breathing</h1>
    <p class="subtitle">Ancient yogic breathing techniques for energy, balance, and inner peace</p>

    <!-- TECHNIQUE SELECTOR -->
    <div class="technique-grid">
      <div class="technique-card active" onclick="selectTechnique('anulom')" data-technique="anulom">
        <div class="technique-icon">üå¨Ô∏è</div>
        <h3>Anulom Vilom</h3>
        <p>Alternate nostril breathing to balance left and right energy channels (Ida & Pingala)</p>
        <div class="technique-meta">
          <span class="meta-badge">Beginner</span>
          <span class="meta-badge">7 mins</span>
        </div>
      </div>
      
      <div class="technique-card" onclick="selectTechnique('bhastrika')" data-technique="bhastrika">
        <div class="technique-icon">‚ö°</div>
        <h3>Bhastrika</h3>
        <p>Bellows breath for instant energy, vitality, and mental alertness</p>
        <div class="technique-meta">
          <span class="meta-badge">Intermediate</span>
          <span class="meta-badge">5 mins</span>
        </div>
      </div>
      
      <div class="technique-card" onclick="selectTechnique('ujjayi')" data-technique="ujjayi">
        <div class="technique-icon">üåä</div>
        <h3>Ujjayi</h3>
        <p>Ocean breath for deep relaxation, focus, and stress relief</p>
        <div class="technique-meta">
          <span class="meta-badge">Beginner</span>
          <span class="meta-badge">8 mins</span>
        </div>
      </div>
    </div>

    <!-- BREATHING SECTION -->
    <div class="breathing-section">
      <div class="technique-description" id="techniqueDesc">
        <h4>Anulom Vilom (Alternate Nostril Breathing)</h4>
        <p>This powerful technique balances the left and right hemispheres of the brain, calms the nervous system, and prepares you for deep meditation. Perfect for exam stress and anxiety relief.</p>
      </div>

      <div class="breathing-visual" id="breathingVisual">
        <div class="visual-instruction" id="visualInstruction">Press Start</div>
        <div class="visual-counter" id="visualCounter">Ready</div>
      </div>

      <div class="nostril-indicator" id="nostrilIndicator" style="display:none;">
        <div class="nostril" id="leftNostril">
          <div class="nostril-icon">üëÉ</div>
          <div class="nostril-label">Left</div>
        </div>
        <div class="nostril" id="rightNostril">
          <div class="nostril-icon">üëÉ</div>
          <div class="nostril-label">Right</div>
        </div>
      </div>

      <div class="round-tracker">
        <span>Round</span>
        <span class="round-num" id="roundNum">0</span>
        <span>of 5</span>
      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls">
      <button class="btn btn-primary" id="startBtn" onclick="startPractice()">‚ñ∂ Start Practice</button>
      <button class="btn btn-secondary" id="pauseBtn" onclick="pausePractice()" style="display:none;">‚è∏ Pause</button>
      <button class="btn btn-secondary" onclick="stopPractice()">‚èπ Stop</button>
    </div>

    <!-- STATS -->
    <div class="stats-section">
      <div class="stat-card">
        <span class="stat-value" id="totalRounds">0</span>
        <span class="stat-label">Total Rounds</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="totalMinutes">0</span>
        <span class="stat-label">Total Minutes</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="sessionsCount">0</span>
        <span class="stat-label">Sessions</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="currentStreak">0</span>
        <span class="stat-label">Day Streak</span>
      </div>
    </div>

    <!-- BENEFITS -->
    <div class="benefits-section">
      <h3>‚ú® Benefits of Pranayama</h3>
      <div class="benefits-grid" id="benefitsGrid">
        <!-- Populated by JS based on technique -->
      </div>
    </div>

    <!-- GUIDE -->
    <div class="guide-section" id="guideSection">
      <h3>üìñ Step-by-Step Guide</h3>
      <div class="steps-grid" id="stepsGrid">
        <!-- Populated by JS based on technique -->
      </div>
    </div>

    <div class="back-link">
      <a href="meditation.html">‚Üê Back to Wellness Hub</a>
    </div>
  </div>

  <script>
    let currentTechnique = 'anulom';
    let isRunning = false;
    let isPaused = false;
    let interval;
    let phase = 0;
    let count = 4;
    let currentRound = 0;
    let totalRoundsCompleted = parseInt(localStorage.getItem('pranayamaTotalRounds') || '0');
    let totalMinutesCompleted = parseInt(localStorage.getItem('pranayamaTotalMinutes') || '0');
    let totalSessions = parseInt(localStorage.getItem('pranayamaSessions') || '0');

    const techniques = {
      anulom: {
        name: 'Anulom Vilom',
        description: 'This powerful technique balances the left and right hemispheres of the brain, calms the nervous system, and prepares you for deep meditation. Perfect for exam stress and anxiety relief.',
        sequence: [
          { text: 'Close Right\nInhale Left', duration: 4, active: true, nostril: 'left' },
          { text: 'Close Both\nHold', duration: 4, active: false, nostril: 'both' },
          { text: 'Close Left\nExhale Right', duration: 4, active: false, nostril: 'right' },
          { text: 'Close Left\nInhale Right', duration: 4, active: true, nostril: 'right' },
          { text: 'Close Both\nHold', duration: 4, active: false, nostril: 'both' },
          { text: 'Close Right\nExhale Left', duration: 4, active: false, nostril: 'left' }
        ],
        rounds: 5,
        totalTime: 7,
        benefits: [
          { icon: 'üß†', text: 'Balances brain hemispheres' },
          { icon: 'üòå', text: 'Reduces anxiety & stress' },
          { icon: 'üéØ', text: 'Improves concentration' },
          { icon: 'üí§', text: 'Better sleep quality' },
          { icon: 'ü´Å', text: 'Strengthens lungs' },
          { icon: 'üßò', text: 'Prepares for meditation' }
        ],
        steps: [
          { title: 'Sit Comfortably', desc: 'Sit in a cross-legged position or on a chair with spine straight and shoulders relaxed.' },
          { title: 'Hand Position', desc: 'Use your right thumb to close your right nostril and ring finger to close your left nostril.' },
          { title: 'Close Right, Inhale Left', desc: 'Close your right nostril with your thumb. Inhale slowly through your left nostril for 4 counts.' },
          { title: 'Hold Both', desc: 'Close both nostrils and hold your breath gently for 4 counts.' },
          { title: 'Close Left, Exhale Right', desc: 'Release your thumb and exhale slowly through your right nostril for 4 counts.' },
          { title: 'Repeat Pattern', desc: 'Now inhale through right, hold both, exhale through left. This completes one round.' }
        ]
      },
      bhastrika: {
        name: 'Bhastrika',
        description: 'The "Bellows Breath" rapidly energizes your entire system, burns toxins, and awakens your inner fire. Great before workouts or when you need instant energy and mental clarity.',
        sequence: [
          { text: 'Rapid\nInhale', duration: 1, active: true, nostril: 'both' },
          { text: 'Rapid\nExhale', duration: 1, active: false, nostril: 'both' }
        ],
        rounds: 10,
        totalTime: 5,
        benefits: [
          { icon: '‚ö°', text: 'Instant energy boost' },
          { icon: 'üî•', text: 'Burns toxins & stress' },
          { icon: 'üß†', text: 'Increases alertness' },
          { icon: 'üí™', text: 'Strengthens core' },
          { icon: 'ü´Ä', text: 'Improves circulation' },
          { icon: 'üò§', text: 'Clears sinuses' }
        ],
        steps: [
          { title: 'Sit Upright', desc: 'Sit in a comfortable position with your spine straight and hands on your knees.' },
          { title: 'Relax Face & Shoulders', desc: 'Keep your face, jaw, and shoulders completely relaxed throughout.' },
          { title: 'Rapid Inhale', desc: 'Breathe in forcefully through your nose, expanding your belly.' },
          { title: 'Rapid Exhale', desc: 'Immediately exhale forcefully, pulling your belly in sharply.' },
          { title: 'Maintain Rhythm', desc: 'Continue this rapid breathing for 10-20 cycles, like pumping a bellows.' },
          { title: 'Rest & Observe', desc: 'After completing, breathe normally and observe the energy flowing through you.' }
        ]
      },
      ujjayi: {
        name: 'Ujjayi',
        description: 'The "Ocean Breath" creates a soothing sound by constricting the throat slightly. This deeply calming technique is perfect for stress relief, insomnia, and maintaining focus during study sessions.',
        sequence: [
          { text: 'Inhale Slowly\n(Throat Sound)', duration: 5, active: true, nostril: 'both' },
          { text: 'Exhale Slowly\n(Throat Sound)', duration: 5, active: false, nostril: 'both' }
        ],
        rounds: 6,
        totalTime: 8,
        benefits: [
          { icon: 'üåä', text: 'Deep relaxation' },
          { icon: 'üò¥', text: 'Cures insomnia' },
          { icon: 'üéØ', text: 'Enhances focus' },
          { icon: 'üíÜ', text: 'Relieves headaches' },
          { icon: 'üßò', text: 'Perfect for yoga' },
          { icon: '‚ùÑÔ∏è', text: 'Cools the mind' }
        ],
        steps: [
          { title: 'Find Your Seat', desc: 'Sit comfortably with your spine tall and shoulders soft.' },
          { title: 'Constrict Throat', desc: 'Slightly constrict the back of your throat, as if whispering "ha" or fogging a mirror.' },
          { title: 'Inhale with Sound', desc: 'Breathe in slowly through your nose, creating a soft ocean-like sound in your throat.' },
          { title: 'Exhale with Sound', desc: 'Exhale slowly through your nose, maintaining the same soothing sound.' },
          { title: 'Keep it Gentle', desc: 'The sound should be audible to you but not forced or strained.' },
          { title: 'Continue Smoothly', desc: 'Maintain steady, equal inhales and exhales throughout your practice.' }
        ]
      }
    };

    // Load stats
    document.getElementById('totalRounds').textContent = totalRoundsCompleted;
    document.getElementById('totalMinutes').textContent = totalMinutesCompleted;
    document.getElementById('sessionsCount').textContent = totalSessions;

    // Calculate streak
    const lastDate = localStorage.getItem('pranayamaLastDate');
    const today = new Date().toDateString();
    let streak = parseInt(localStorage.getItem('pranayamaStreak') || '0');
    if (lastDate === today) {
      document.getElementById('currentStreak').textContent = streak;
    } else {
      document.getElementById('currentStreak').textContent = 0;
    }

    function selectTechnique(tech) {
      if (isRunning) {
        alert('Please stop the current practice first!');
        return;
      }
      
      currentTechnique = tech;
      document.querySelectorAll('.technique-card').forEach(c => c.classList.remove('active'));
      document.querySelector(`[data-technique="${tech}"]`).classList.add('active');
      
      updateTechniqueInfo();
      resetPractice();
    }

    function updateTechniqueInfo() {
      const tech = techniques[currentTechnique];
      
      // Update description
      document.getElementById('techniqueDesc').innerHTML = `
        <h4>${tech.name}</h4>
        <p>${tech.description}</p>
      `;
      
      // Show/hide nostril indicator
      if (currentTechnique === 'anulom') {
        document.getElementById('nostrilIndicator').style.display = 'flex';
      } else {
        document.getElementById('nostrilIndicator').style.display = 'none';
      }
      
      // Update benefits
      const benefitsHTML = tech.benefits.map(b => `
        <div class="benefit-card">
          <h4>${b.icon}</h4>
          <p>${b.text}</p>
        </div>
      `).join('');
      document.getElementById('benefitsGrid').innerHTML = benefitsHTML;
      
      // Update steps
      const stepsHTML = tech.steps.map((s, i) => `
        <div class="step-card">
          <div class="step-number">${i + 1}</div>
          <div class="step-content">
            <h4>${s.title}</h4>
            <p>${s.desc}</p>
          </div>
        </div>
      `).join('');
      document.getElementById('stepsGrid').innerHTML = stepsHTML;
    }

    function startPractice() {
      if (isRunning && !isPaused) return;
      
      if (!isRunning) {
        currentRound = 0;
        phase = 0;
      }
      
      isRunning = true;
      isPaused = false;
      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('pauseBtn').style.display = 'inline-block';
      
      runCycle();
    }

    function pausePractice() {
      isPaused = true;
      isRunning = false;
      clearInterval(interval);
      document.getElementById('startBtn').style.display = 'inline-block';
      document.getElementById('pauseBtn').style.display = 'none';
      document.getElementById('visualInstruction').textContent = 'Paused';
    }

    function stopPractice() {
      isRunning = false;
      isPaused = false;
      clearInterval(interval);
      resetPractice();
    }

    function resetPractice() {
      document.getElementById('startBtn').style.display = 'inline-block';
      document.getElementById('pauseBtn').style.display = 'none';
      document.getElementById('breathingVisual').className = 'breathing-visual';
      document.getElementById('visualInstruction').textContent = 'Press Start';
      document.getElementById('visualCounter').textContent = 'Ready';
      document.getElementById('roundNum').textContent = '0';
      document.getElementById('leftNostril').classList.remove('active');
      document.getElementById('rightNostril').classList.remove('active');
      currentRound = 0;
      phase = 0;
    }

    function runCycle() {
      if (!isRunning) return;

      const tech = techniques[currentTechnique];
      const sequence = tech.sequence;
      const current = sequence[phase];
      count = current.duration;

      document.getElementById('visualInstruction').textContent = current.text;

      // Handle nostril indicators for Anulom Vilom
      if (currentTechnique === 'anulom') {
        document.getElementById('leftNostril').classList.remove('active');
        document.getElementById('rightNostril').classList.remove('active');
        
        if (current.nostril === 'left') {
          document.getElementById('leftNostril').classList.add('active');
        } else if (current.nostril === 'right') {
          document.getElementById('rightNostril').classList.add('active');
        } else if (current.nostril === 'both') {
          document.getElementById('leftNostril').classList.add('active');
          document.getElementById('rightNostril').classList.add('active');
        }
      }

      // Handle animations
      if (current.active) {
        if (currentTechnique === 'bhastrika') {
          document.getElementById('breathingVisual').classList.add('bhastrika-active');
        } else {
          document.getElementById('breathingVisual').classList.add('active');
        }
      } else {
        document.getElementById('breathingVisual').classList.remove('active', 'bhastrika-active');
      }

      interval = setInterval(() => {
        count--;
        document.getElementById('visualCounter').textContent = count;

        if (count <= 0) {
          clearInterval(interval);
          phase++;

          if (phase >= sequence.length) {
            phase = 0;
            currentRound++;
            document.getElementById('roundNum').textContent = currentRound;

            if (currentRound >= tech.rounds) {
              completeSession();
              return;
            }
          }

          runCycle();
        }
      }, 1000);
    }

    function completeSession() {
      isRunning = false;
      clearInterval(interval);

      const tech = techniques[currentTechnique];
      
      // Save progress
      totalRoundsCompleted += tech.rounds;
      totalMinutesCompleted += tech.totalTime;
      totalSessions++;
      
      localStorage.setItem('pranayamaTotalRounds', totalRoundsCompleted);
      localStorage.setItem('pranayamaTotalMinutes', totalMinutesCompleted);
      localStorage.setItem('pranayamaSessions', totalSessions);
      
      // Update streak
      const lastDate = localStorage.getItem('pranayamaLastDate');
      const today = new Date().toDateString();
      let streak = parseInt(localStorage.getItem('pranayamaStreak') || '0');
      
      if (lastDate !== today) {
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        
        if (lastDate === yesterday.toDateString()) {
          streak++;
        } else {
          streak = 1;
        }
        
        localStorage.setItem('pranayamaStreak', streak);
        localStorage.setItem('pranayamaLastDate', today);
      }

      // Update display
      document.getElementById('totalRounds').textContent = totalRoundsCompleted;
      document.getElementById('totalMinutes').textContent = totalMinutesCompleted;
      document.getElementById('sessionsCount').textContent = totalSessions;
      document.getElementById('currentStreak').textContent = streak;

      document.getElementById('breathingVisual').classList.remove('active', 'bhastrika-active');
      document.getElementById('visualInstruction').textContent = 'Complete! üôè';
      document.getElementById('visualCounter').textContent = '‚ú®';

      setTimeout(() => {
        alert(`üïâ ${tech.name} Complete!\n\n‚úÖ ${tech.rounds} rounds completed\n‚è±Ô∏è ${tech.totalTime} minutes practiced\nüî• ${streak} day streak\n\nNamaste! Your practice is creating lasting positive changes. üôè`);
        resetPractice();
      }, 500);
    }

    // Initialize on load
    updateTechniqueInfo();
  </script>
</body>
</html>
