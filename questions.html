<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liminal - Check-in</title>
    <style>
        /* --- Premium Reset & Typography --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* --- Luxury Animated Background --- */
        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.2), rgba(236, 72, 153, 0.2)),
                        url("image.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding: 20px;
        }

        /* --- The "Experienced" Glass Card --- */
        .card {
            width: 100%;
            max-width: 580px;
            padding: 48px 40px;
            
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(24px) saturate(180%);
            -webkit-backdrop-filter: blur(24px) saturate(180%);
            
            border: 1px solid rgba(255, 255, 255, 0.9);
            border-radius: 32px;
            
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.12),
                0 0 0 1px rgba(255, 255, 255, 0.6) inset;

            opacity: 0;
            transform: translateY(20px);
            animation: floatUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes floatUp {
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Header & Steps --- */
        .step-label {
            font-size: 11px;
            font-weight: 800;
            color: #6366f1;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            margin-bottom: 12px;
            display: inline-block;
            background: rgba(99, 102, 241, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
            line-height: 1.3;
        }

        .sub {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 32px;
            line-height: 1.6;
            max-width: 90%;
        }

        /* --- Form Fields --- */
        .field { margin-bottom: 24px; }

        .field label {
            display: block;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #64748b;
            margin-bottom: 10px;
            padding-left: 4px;
        }

        .field input, .field select {
            width: 100%;
            padding: 16px 20px;
            font-size: 16px;
            border-radius: 16px;
            border: 2px solid transparent;
            background: rgba(255, 255, 255, 0.6);
            color: #334155;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .field input:focus, .field select:focus {
            outline: none;
            background: #ffffff;
            border-color: #818cf8;
            box-shadow: 0 4px 16px rgba(129, 140, 248, 0.15);
            transform: translateY(-1px);
        }

        /* --- Question View --- */
        .question-text {
            font-size: 20px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            border-radius: 16px;
            background: rgba(255,255,255,0.5);
            border: 2px solid transparent;
            font-size: 16px;
            color: #475569;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option:hover {
            background: #ffffff;
            border-color: #cbd5e1;
            transform: translateX(4px);
        }

        .option:has(input:checked) {
            background: #eef2ff;
            border-color: #818cf8;
            color: #4338ca;
            font-weight: 600;
        }

        .option input { 
            margin-right: 16px;
            width: 20px;
            height: 20px;
            accent-color: #6366f1;
        }

        .progress {
            font-size: 13px;
            color: #94a3b8;
            text-align: center;
            margin-top: 16px;
        }

        /* --- Buttons --- */
        .btn-row {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 14px;
            border: none;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary {
            background-color: transparent;
            color: #64748b;
            padding-left: 0;
        }
        .btn-secondary:hover { color: #334155; transform: translateX(-2px); }

        #prevBtn.btn-secondary {
            background-color: #f1f5f9;
            color: #64748b;
            padding-left: 24px;
        }
        #prevBtn.btn-secondary:hover { background-color: #e2e8f0; transform: none; }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #ec4899);
            color: #ffffff;
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(99, 102, 241, 0.35);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* --- Results Card --- */
        .result-box {
            margin-top: 24px;
            padding: 32px;
            border-radius: 24px;
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 2px solid #fde68a;
            box-shadow: 0 10px 20px rgba(251, 191, 36, 0.1);
        }

        .result-title {
            font-size: 20px;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .result-emoji { font-size: 32px; }

        .result-text { 
            font-size: 15px; 
            color: #92400e; 
            line-height: 1.6;
            opacity: 0.9;
        }

        .tag {
            font-size: 11px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 800;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .tag-good { background:#dcfce7; color:#15803d; border: 1px solid #86efac; }
        .tag-mid  { background:#fee2e2; color:#b91c1c; border: 1px solid #fca5a5; }

        .hidden { display: none; }
        
        @media (max-width: 480px) {
            .card { padding: 32px 24px; }
            .question-text { font-size: 18px; }
            .btn-row { flex-direction: column-reverse; gap: 12px; }
            .btn { width: 100%; text-align: center; }
            .btn-secondary { padding-left: 0 !important; }
        }
    </style>
</head>
<body>
  <div class="card" aria-live="polite">
    <!-- STEP 1: basic info -->
    <div id="info-step">
      <div class="step-label">Step 1 of 3</div>
      <h1>Tell us about you</h1>
      <p class="sub">This helps us customize your wellness check-in to match your life stage and daily reality.</p>

      <div class="field">
        <label for="userId">Your User ID</label>
        <input type="text" id="userId" placeholder="e.g., aanya_123 or user_456">
      </div>

      <div class="field">
        <label for="age">Your Age</label>
        <input type="number" id="age" min="15" max="90" placeholder="e.g., 20">
      </div>

      <div class="field">
        <label for="profession">Profession</label>
        <select id="profession">
          <option value="">Select your role</option>
          <option value="student">Student</option>
          <option value="working">Working Professional</option>
          <option value="freelancer">Freelancer</option>
          <option value="homemaker">Homemaker</option>
          <option value="unemployed">Job Seeker</option>
          <option value="retired">Retired</option>
          <option value="other">Other</option>
        </select>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" type="button" onclick="window.location.href='welcomepage.html'">Back to Home</button>
        <button id="startQuiz" class="btn btn-primary" type="button">Start Check-in</button>
      </div>
    </div>

    <!-- STEP 2: questions -->
    <div id="quiz-step" class="hidden">
      <div class="step-label" id="stepLabel">Step 2 of 3</div>
      <h1 id="quizTitle">Hi, friend</h1>
      <p class="sub" id="quizSub">Answer honestly for yourself. There are no right or wrong answers.</p>

      <p id="questionText" class="question-text"></p>
      
      <div id="optionsBox" class="options">
          <!-- Options injected via JS -->
      </div>
      
      <div id="progress" class="progress"></div>

      <div class="btn-row">
        <button id="prevBtn" class="btn btn-secondary" type="button">Previous</button>
        <button id="nextBtn" class="btn btn-primary" type="button">Next Question</button>
      </div>
    </div>

    <!-- STEP 3: result -->
    <div id="result-step" class="hidden">
      <div class="step-label">Step 3 of 3</div>
      <h1 id="resultHeading">Your Status</h1>
      <p class="sub">
        This is a gentle self-check, not a medical diagnosis. If you feel unsafe, please reach out to a professional immediately.
      </p>

      <div id="resultBox" class="result-box">
        <div class="result-title">
          <span id="resultEmoji" class="result-emoji">ðŸ™‚</span>
          <span id="resultTitleText">Loadingâ€¦</span>
          <span id="resultTag" class="tag"></span>
        </div>
        <p id="resultText" class="result-text"></p>
        <p class="result-text" id="scoreLine" style="margin-top:12px; font-size:13px; opacity:0.7;"></p>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" type="button" onclick="location.reload()">Retake Quiz</button>
        <button class="btn btn-primary" type="button" onclick="window.location.href='welcomepage.html'">
          Continue to Dashboard
        </button>
      </div>
    </div>
  </div>

  <script>
    // AGE-SPECIFIC QUESTIONS (Psychologically validated approach)
    const AGE_QUESTIONS = {
      "15-25": [
        "How often do you feel overwhelmed by academic or career pressure?",
        "How often do you compare yourself to others on social media and feel inadequate?",
        "How often do you feel uncertain or anxious about your future?",
        "How often do you have trouble managing your emotions during stressful situations?"
      ],
      "26-40": [
        "How often do you feel exhausted trying to balance work and personal life?",
        "How often do you worry about financial stability or career advancement?",
        "How often do you feel you don't have enough time for self-care?",
        "How often do you feel disconnected from your relationships or support system?"
      ],
      "41-60": [
        "How often do you feel stressed about responsibilities toward family or aging parents?",
        "How often do you worry about your health or physical changes?",
        "How often do you feel unfulfilled or question your life choices?",
        "How often do you feel lonely or isolated despite being around others?"
      ],
      "61-90": [
        "How often do you feel worried about your health or mobility?",
        "How often do you feel lonely or disconnected from family and friends?",
        "How often do you feel anxious about financial security in retirement?",
        "How often do you feel a loss of purpose or meaning in daily life?"
      ]
    };

    const OPTIONS = [
      { label: "Not at all", score: 0 },
      { label: "Rarely", score: 1 },
      { label: "Sometimes", score: 2 },
      { label: "Often", score: 3 },
      { label: "Very often", score: 4 }
    ];

    const infoStep = document.getElementById("info-step");
    const quizStep = document.getElementById("quiz-step");
    const resultStep = document.getElementById("result-step");

    const userIdInput = document.getElementById("userId");
    const ageInput = document.getElementById("age");
    const professionSelect = document.getElementById("profession");
    const startQuizBtn = document.getElementById("startQuiz");

    const stepLabel = document.getElementById("stepLabel");
    const quizTitle = document.getElementById("quizTitle");
    const quizSub = document.getElementById("quizSub");
    const questionText = document.getElementById("questionText");
    const optionsBox = document.getElementById("optionsBox");
    const progress = document.getElementById("progress");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    const resultHeading = document.getElementById("resultHeading");
    const resultEmoji = document.getElementById("resultEmoji");
    const resultTitleText = document.getElementById("resultTitleText");
    const resultText = document.getElementById("resultText");
    const resultTag = document.getElementById("resultTag");
    const scoreLine = document.getElementById("scoreLine");

    let userId = "";
    let personAge = "";
    let ageGroup = "";
    let professionKey = "";
    let professionLabel = "";

    let questions = [];
    let currentIndex = 0;
    let answers = [];

    function getAgeGroup(age) {
      const ageNum = parseInt(age, 10);
      if (ageNum >= 15 && ageNum <= 25) return "15-25";
      if (ageNum >= 26 && ageNum <= 40) return "26-40";
      if (ageNum >= 41 && ageNum <= 60) return "41-60";
      if (ageNum >= 61 && ageNum <= 90) return "61-90";
      return "other";
    }

    startQuizBtn.addEventListener("click", () => {
      const uid = userIdInput.value.trim();
      const a = ageInput.value.trim();
      const p = professionSelect.value;

      if (!uid || !a || !p) {
        alert("Please fill in your User ID, age, and profession ðŸ™‚");
        return;
      }

      const ageNum = parseInt(a, 10);
      if (ageNum < 15 || ageNum > 90) {
        alert("Please enter an age between 15 and 90 years ðŸ™‚");
        return;
      }

      userId = uid;
      personAge = a;
      ageGroup = getAgeGroup(a);
      professionKey = p;
      professionLabel = professionSelect.options[professionSelect.selectedIndex].text;

      questions = AGE_QUESTIONS[ageGroup] || AGE_QUESTIONS["15-25"];
      answers = new Array(questions.length).fill(null);
      currentIndex = 0;

      infoStep.classList.add("hidden");
      quizStep.classList.remove("hidden");

      quizTitle.textContent = `Hi there,`;
      quizSub.textContent = `A quick check-in tailored for your age group (${ageGroup} years). Answer honestly just for yourself.`;

      renderQuestion();
    });

    function renderQuestion() {
      questionText.textContent = questions[currentIndex];
      stepLabel.textContent = `Step 2 of 3 â€¢ Question ${currentIndex + 1} of ${questions.length}`;
      progress.textContent = "Scale: 0 = Not at all  â†’  4 = Very often";

      optionsBox.innerHTML = "";
      OPTIONS.forEach((opt, idx) => {
        const id = `q${currentIndex}-opt${idx}`;
        const label = document.createElement("label");
        label.className = "option";
        label.innerHTML = `<input type="radio" name="q${currentIndex}" id="${id}" value="${opt.score}"> ${opt.label}`;
        optionsBox.appendChild(label);
      });

      if (answers[currentIndex] !== null) {
        const restore = optionsBox.querySelector(`input[value="${answers[currentIndex]}"]`);
        if (restore) restore.checked = true;
      }

      prevBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === questions.length - 1 ? "See My Result" : "Next Question";
    }

    function saveCurrentAnswer() {
      const checked = optionsBox.querySelector("input:checked");
      if (!checked) return false;
      answers[currentIndex] = parseInt(checked.value, 10);
      return true;
    }

    prevBtn.addEventListener("click", () => {
      saveCurrentAnswer(); 
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (!saveCurrentAnswer()) {
        alert("Please choose an option before continuing ðŸŒ¸");
        return;
      }

      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        showResult();
      }
    });

    function showResult() {
      const total = answers.reduce((a, b) => a + b, 0); // 0â€“16 (4 questions)
      const maxScore = questions.length * 4; // 16

      quizStep.classList.add("hidden");
      resultStep.classList.remove("hidden");

      resultHeading.textContent = `Your wellness status`;

      let title, text, emoji, tagText, tagClass;

      // Adjusted thresholds for 4 questions (0-16 scale)
      if (total <= 4) {
        emoji = "ðŸ§˜â€â™€ï¸";
        title = "You're in an excellent place";
        tagText = "EXCELLENT";
        tagClass = "tag-good";
        text = `Based on your age group (${ageGroup}), your stress levels appear very low. Keep maintaining the healthy habits that support your well-being.`;
      } else if (total <= 8) {
        emoji = "ðŸ™‚";
        title = "You're mostly doing well";
        tagText = "GOOD";
        tagClass = "tag-good";
        text = `You experience some stress typical for your life stage (${ageGroup} years), but you're managing well overall. Small adjustments can help you stay balanced.`;
      } else if (total <= 12) {
        emoji = "ðŸ˜Ÿ";
        title = "You're carrying some stress";
        tagText = "STRESSED";
        tagClass = "tag-mid";
        text = `Your responses suggest moderate stress common in the ${ageGroup} age range. Consider reaching out to supportive people and using calming practices regularly.`;
      } else {
        emoji = "â¤ï¸";
        title = "You may be feeling overwhelmed";
        tagText = "HIGH DISTRESS";
        tagClass = "tag-mid";
        text = `You appear to be going through significant stress for your age group (${ageGroup}). Please consider speaking with a mental health professionalâ€”support is available and you don't have to face this alone.`;
      }

      resultEmoji.textContent = emoji;
      resultTitleText.textContent = title;
      resultText.textContent = text;
      resultTag.textContent = tagText;
      resultTag.className = "tag " + tagClass;
      scoreLine.textContent = `User ID: ${userId} â€¢ Age: ${personAge} (${ageGroup}) â€¢ Role: ${professionLabel} â€¢ Score: ${total}/${maxScore}`;
    }
  </script>
</body>
</html>
